(function(){var t={},q=function(a,f,h){var g=function(b,g){if(p(b)&&!s(b))for(var a=0,k=b.length;a<k;a++)g.apply(b,[a,b[a]]);if(m(b)&&!s(b))for(var l in b)b.hasOwnProperty(l)&&g.apply(b,[l,b[l]])},b=function(b,g,a){var k=0,l=0,f=!1,h=!1,n=function(b,c){l++;g(b,c,function(b){f||(b?(f=!0,a(b)):(k++,h&&k==l&&a()))})};if(p(b)&&!s(b))for(var r=0,w=b.length;r<w;r++)n(r,b[r]);else if(m(b)&&!s(b))for(r in b)b.hasOwnProperty(r)&&n(r,b[r]);else return a();(h=!0)&&k==l&&a()};return"undefined"===typeof h?g.apply(this,
arguments):b.apply(this,arguments)},A=function(a,f){return Array.prototype.every.apply(a,[f])},F=function(a,f,h){return Array.prototype.filter.apply(a,[f,h||this])},p=function(a){return"[object Array]"===Object.prototype.toString.call(a)},G=function(a){return"boolean"===typeof a},y=function(a){return"undefined"!==typeof a},s=function(a){if(u(a))return!1;if(null===a)return!0;if(p(a)||"string"===typeof a)return 0===a.length;if(m(a))for(var f in a)if(hasOwnProperty.call(a,f))return!1;return!0},B=function(a,
f){if(p(a,f))return a.length!==f.length?!1:A(a,function(b,g,a){return f[g]===b});if(m(a,f)){var h=Object.keys(a),g=Object.keys(f);if(!B(h,g))return!1;for(key in a)if(!f[key]||a[key]!==f[key])return!1;return!0}return!1},z=function(a){return"function"===typeof a},C=function(a){return u(a)&&0===a%1},H=function(a){return null===a},u=function(a){return"number"===typeof a},m=function(a){return"[object Object]"===Object.prototype.toString.call(a)},n=function(a){return"string"===typeof a},x=function(a){return"undefined"===
typeof a},D=function(a,f){for(var h in f)f.hasOwnProperty(h)&&!a.hasOwnProperty(h)&&(a[h]=f[h]);return a},E=function(a,f){for(var h=[],g=0,b=a.length;g<b;g++){var c=a[g][f];-1===h.indexOf(c)&&h.push(c)}return h},I=function(){return!0};(function(){var a=function(g){var b=this,c={singleError:!0,messages:h,cache:!1};q(c,function(a,e){m(e)&&g[a]?b[a]=D(g[a],c[a]):m(e)&&!g[a]?b[a]=D({},c[a]):b[a]=y(g[a])?g[a]:c[a]});this.errors=new f(this)};a.prototype.attributes={};a.prototype.addAttribute=function(g,
b){return a.prototype.attributes[g]=b};a.prototype.addAttributeConstructor=function(g,b){return a.prototype.attributes[g]=b()};a.prototype.addAttribute("additionalProperties",function(g,b,a,d,e){var k=this;if(!0===a)return e();var l=Object.keys(b),l=F(l,function(b){return!d.properties[b]});if(s(l))return e();if(!1===a)return l.forEach(function(a){this.addError({property:this.joinPath(g,a),propertyValue:b[a]})},this),e();if(m(a))return q(l,function(e,d,l){return k.validateSchema(b[d],a,g+d,l)},e)});
a.prototype.addAttribute("divisibleBy",function(g,b,a,d,e){if(0===a)return this.addError("The value of this attribute should not be 0."),e();u(b)&&0!==b%a&&this.addError();return e()});a.prototype.addAttribute("enum",function(g,b,a,d,e){-1===a.indexOf(b)&&this.addError();return e()});a.prototype.addAttribute("except",function(g,b,a,d,e){-1!==a.indexOf(b)&&this.addError();return e()});a.prototype.addAttributeConstructor("format",function(){var g={"date-time":{type:"string",pattern:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-[0-9]{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/},
date:function(b){return n(b)?b.match(/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-[0-9]{2}$/):m(b)?"[object Date]"===Object.prototype.toString.call(b):!1},time:{type:"string",pattern:/^\d{2}:\d{2}:\d{2}$/},"utc-milisec":{type:"number"},regex:function(b){return b&&b.test&&b.exec},color:{type:"string"},style:{type:"string"},phone:{type:"number"},uri:{type:"string",pattern:/^(?:(?:ht|f)tp(?:s?)\:\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|cat|coop|int|pro|tel|xxx|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2})?)|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |\/.,*:;=]|%[a-f\d]{2})*)?$/},
email:{type:"string",pattern:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/},"ip-address":{type:"string",pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/},ipv6:{type:"string",pattern:/(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})|(?:(?:[a-f\d]{1,4}:)*[a-f\d]{1,4})?::(?:(?:[a-f\d]{1,4}:)*(?:[a-f\d]{1,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}))?)/},
"host-name":{type:"string"},alpha:{required:!0,type:"string",pattern:/^[a-zA-Z]+$/},alphanumeric:{required:!0,type:["string","number"],pattern:/^[a-zA-Z0-9]+$/},decimal:function(b){return u(b)?(b+"").match(/^[0-9]+(\.[0-9]{1,2})?$/):!1},percentage:{required:!0,type:["string","number"],pattern:/^-?[0-9]{0,2}(\.[0-9]{1,2})?$|^-?(100)(\.[0]{1,2})?$/,minimum:-100,maximum:100},port:{required:!0,type:["string","number"],pattern:/\:\d+/}};q({url:"uri",ip:"ip-address",ipv4:"ip-address",host:"host-name",hostName:"host-name"},
function(b,a){g[b]=g[a]});return function(b,a,d,e,k){if(m(d))return this.validateProperty(b,a,d,k);if(n(d)&&!Object.prototype.hasOwnProperty.apply(g,[d]))return this.addError("The format \u2018"+d+"\u2019 is not supported."),k();if(n(d)){d=g[d];if(z(d))return d(a)||this.addError(),k();if(m(d))return this.validateProperty(b,a,d,k)}}});a.prototype.addAttribute("length",function(g,b,a,d,e){n(b)&&b.length!==a&&this.addError();return e()});a.prototype.addAttribute("maximum",function(g,b,a,d,e){u(b)&&(d.exclusiveMaximum&&
b>=a||b>a)&&this.addError();return e()});a.prototype.addAttribute("maxItems",function(g,b,a,d,e){p(b)&&b.length>a&&this.addError();return e()});a.prototype.addAttribute("maxLength",function(g,b,a,d,e){n(b)&&b.length>a&&this.addError();return e()});a.prototype.addAttribute("minimum",function(g,b,a,d,e){u(b)&&(d.exclusiveMinimum&&b<=a||b<a)&&this.addError();return e()});a.prototype.addAttribute("minItems",function(g,b,a,d,e){p(b)&&b.length<a&&this.addError();return e()});a.prototype.addAttribute("minLength",
function(g,b,a,d,e){n(b)&&b.length<a&&this.addError();return e()});a.prototype.addAttribute("pattern",function(a,b,c,d,e){n(b)&&!b.match(c)&&this.addError();return e()});(function(){a.prototype.addAttribute("patternProperties",function(a,b,c,d,e){var k=this;if(s(c))return e();var l={},f=Object.keys(c);q(b,function(b,a){q(f,function(a,g){b.match(RegExp(g))&&(l[b]=c[g])})});if(s(l))return e();q(l,function(c,e,d){return k.validateSchema(b[c],e,k.joinPath(a,c),d)},e)})})();a.prototype.addAttribute("required",
function(a,b,c,d,e){c&&(a=x(b),b=(n(b)||p(b)||m(b))&&s(b),(a||b)&&this.addError());return e()});a.prototype.addAttributeConstructor("type",function(){var a={string:n,number:u,"function":z,"boolean":G,object:m,array:p,integer:C,"int":C,"null":H,any:I};return function(b,c,d,e,k){if(p(d)){if(!A(d,function(b){return Object.prototype.hasOwnProperty.apply(a,[b])}))return this.addError("One of the following types \u2018"+d.join(",")+"\u2019 is not supported."),k();d.some(function(b){return a[b](c)})||this.addError()}else Object.prototype.hasOwnProperty.apply(a,
[d])?a[d](c)||this.addError():this.addError("Type \u2018"+d+"\u2019 is not supported.");return k()}});(function(){a.prototype.addAttribute("uniqueItems",function(a,b,c,d,e){var k=this;q(b,function(c,e){n(e)&&b.indexOf(e)<c&&k.addError();(m(e)||p(e))&&b.forEach(function(b,d){d!==c&&B(e,b)&&k.addError({property:k.joinPath(a,d)})})});return e()})})();var f=function(a){this.length=0;this.errorMessages=a.messages};f.prototype.renderErrorMessage=function(a){var b=this.errorMessages[a.attributeName];return b&&
z(b)?b(a.property,a.propertyValue,a.attributeValue):b&&n(b)?(["property","propertyValue","attributeValue"].forEach(function(c){b=b.replace(RegExp("{{"+c+"}}","g"),a[c])}),b=b.replace(/{{validator}}/g,a.attributeValue),b.replace(/\s+/g," ")):a.message};f.prototype.push=function(a){this[this.length]={property:a.property,propertyValue:a.propertyValue,attributeName:a.attributeName,attributeValue:a.attributeValue,message:this.renderErrorMessage(a),validator:a.attributeName,validatorName:a.attributeName,
validatorValue:a.attributeValue};this.length+=1};f.prototype.getProperties=function(){return E(this,"property")};f.prototype.getMessages=function(){return E(this,"message")};var h={required:function(a,b,c){return"The \u2018"+a+"\u2019 property is required."},minLength:function(a,b,c){return["The "+a+" property must be at least "+c+" characters.","The length of the property is "+b.length+"."].join(" ")},maxLength:function(a,b,c){return["The "+a+" property must not exceed "+c+" character"+(1<c?"s":
"")+".","The length of the property is "+b.length+"."].join(" ")},length:function(a,b,c){return["The "+a+" property must be exactly "+c+" character"+(1<c?"s":"")+".","The length of the property is "+b.length+"."].join(" ")},format:function(a,b,c){return["The \u2018"+a+"\u2019 property must be a/an \u2018"+c+"\u2019.","The current value of the property is \u2018"+b+"\u2019"].join(" ")},type:function(a,b,c){return["The \u2018"+a+"\u2019 property must be "+(-1<"aeiou".indexOf(c[0])?"an":"a")+" \u2018"+
c+"\u2019.","The type of the property is \u2018"+typeof b+"\u2019"].join(" ")},except:function(a,b,c){},minimum:function(a,b,c){return["The minimum value of the \u2018"+a+"\u2019 must be "+c+".","The current value of the property is \u2018"+b+"\u2019"].join(" ")},maximum:function(a,b,c){return["The maximum value of the \u2018"+a+"\u2019 must be "+c+".","The current value of the property is \u2018"+b+"\u2019."].join(" ")},pattern:function(a,b,c){return"The \u2018"+a+"\u2019 does not match the \u2018"+
c+"\u2019 pattern."},maxItems:function(a,b,c){return["The \u2018"+a+"\u2019 property must not contain more than \u2018"+c+"\u2019 items.","Currently it contains \u2018"+b.items+"\u2019 items."].join(" ")},minItems:function(a,b,c){return["The \u2018"+a+"\u2019 property must contain at least \u2018"+c+"\u2019 items.","Currently it contains \u2018"+b.items+"\u2019 items."].join(" ")},divisibleBy:function(a,b,c){return"The \u2018"+a+"\u2019 is not divisible by \u2018"+c+"\u2019."},uniqueItems:function(a,
b,c){return"All items in the \u2018"+a+"\u2019 property must be unique."},"enum":function(a,b,c){return"Value of the \u2018"+a+"\u2019 must be "+c.join(" or ")+"."}};a.prototype.getProperty=function(a,b){if(b)return y(b[a])?b[a]:void 0};a.prototype.joinPath=function(a,b){a=a||"";b+="";return b.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)?a?a+"."+b:b:b.match(/^\d+$/)?a+"["+b+"]":a+'["'+b+'"]'};a.prototype.validate=function(a,b,c){var d=this;this.instance=a;this.schema=b;var e=function(){return 0!==d.errors.length?
c(d.errors):c()};if(-1!=="string number function boolean integer int null".split(" ").indexOf(b.type))return this.validateProperty(void 0,a,b,e);if(-1!==["object","array"].indexOf(b.type)){if(n(a))try{a=JSON.parse(a)}catch(k){}return this.validateSchema(a,b,"",e)}if("any"===b.type||!b.type){if(n(a))try{return a=JSON.parse(a),this.validateSchema(a,b,"",e)}catch(l){}return m(a)||p(a)?this.validateSchema(a,b,"",e):this.validateProperty(void 0,a,b,e)}};a.prototype.validateItems=function(a,b,c,d){var e=
this;x(a)&&(a=[]);return p(b.items)?x(b.additionalItems)||!0===b.additionalItems?q(b.items,function(b,d,f){return e.validateSchema(a[b],d,e.joinPath(c,b),f)},d):q(a,function(a,d,g){if(b.items[a]||m(b.additionalItems))return e.validateSchema(d,b.items[a],e.joinPath(c,a),g);if(!1===b.additionalItems)return e.errors.push({property:e.joinPath(c,a),propertyValue:d,attributeName:"additionalItems",attributeValue:!1}),g()},d):m(b.items)&&a&&!s(a)?q(a,function(d,f,h){return e.validateSchema(a[d],b.items,e.joinPath(c,
d),h)},d):d()};a.prototype.validateProperties=function(a,b,c,d){var e=this;return q(b.properties,function(d,f,h){var m="object"===f.type&&f.properties,n="array"===f.type,r=e.getProperty(d,a),w=e.joinPath(c,d);return m||n?e.validateSchema(r,b.properties[d],w,h):e.validateProperty(w,r,f,h)},d)};a.prototype.validateProperty=function(a,b,c,d){var e=this,f={};"validateItems validateProperties validateSchema validateProperty getProperty attributes errors joinPath".split(" ").forEach(function(a){f[a]=this[a]},
e);return!0!==c.required&&x(b)?d():q(e.attributes,function(d,h,p){var q=e.errors.length;f.addError=function(f){return m(f)?e.errors.push({property:f.property||a,propertyValue:f.propertyValue||b,attributeName:f.attributeName||d,attributeValue:f.attributeValue||c[d],message:f.message||void 0}):e.errors.push({property:a,propertyValue:b,attributeName:d,attributeValue:c[d],message:f})};var r=function(a){return!0===a||n(a)?(f.addError(a),p(!0)):e.errors.length>q&&e.singleError?p(!0):p()};return y(c[d])?
h.apply(f,[a,b,c[d],c,r]):p()},d)};a.prototype.validateSchema=function(a,b,c,d){var e=this;return e.validateProperty(c,a,b,function(f){return b.properties?e.validateProperties(a,b,c,d):b.items?e.validateItems(a,b,c,d):d()})};t.json=function(){return{validate:function(f,b,c,d){"function"===typeof c&&(d=c,c={});return(new a(c)).validate(f,b,d)},addAttribute:function(f,b){return a.prototype.addAttribute.apply(a,arguments)},addAttributeConstructor:function(f,b){return a.prototype.addAttributeConstructor.apply(a,
arguments)}}}()})();var v=function(a){if(!Object.prototype.hasOwnProperty.apply(t,[a]))throw Error("The \u2018"+a+"\u2019 engine is not supported. Please use a different one.");return t[a]};v.validate=function(a,f,h,g){var b=t.json;return b.validate.apply(b,arguments)};v.addValidator=function(a,f){var h=t.json;return h.addAttribute.apply(h,arguments)};v.addAttribute=function(a,f){var h=t.json;return h.addAttribute.apply(h,arguments)};v.addAttributeConstructor=function(a,f){var h=t.json;return h.addAttributeConstructor.apply(h,
arguments)};"undefined"!==typeof module&&module.exports?module.exports=v:"undefined"!==typeof define?define(function(){return v}):this.amanda=v})();
